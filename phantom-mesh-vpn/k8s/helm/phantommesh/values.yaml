# Default values for phantommesh.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# Global settings
global:
  imageRegistry: ""
  imagePullSecrets: []
  storageClass: ""

# PhantomMesh VPN Core settings
vpnCore:
  enabled: true
  replicaCount: 1
  image:
    repository: phantommesh/phantom-node
    tag: "latest"
    pullPolicy: Always
  service:
    type: LoadBalancer
    port: 51820
    apiPort: 8080
  resources:
    limits:
      cpu: 2000m
      memory: 4Gi
    requests:
      cpu: 500m
      memory: 1Gi
  nodeSelector: {}
  tolerations: []
  affinity: {}
  securityContext:
    runAsNonRoot: true
    runAsUser: 1000
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: true
    capabilities:
      add: ["NET_ADMIN", "SYS_MODULE"]

# Agent Swarm settings
agentSwarm:
  enabled: true
  replicaCount: 2
  image:
    repository: phantommesh/agent-swarm
    tag: "latest"
    pullPolicy: Always
  service:
    type: ClusterIP
    port: 8000
  resources:
    limits:
      cpu: 1000m
      memory: 2Gi
    requests:
      cpu: 200m
      memory: 512Mi
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 10
    targetCPUUtilizationPercentage: 70
    targetMemoryUtilizationPercentage: 80
  nodeSelector: {}
  tolerations: []
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app: agent-swarm
            topologyKey: kubernetes.io/hostname

# Discovery Service settings
discovery:
  enabled: true
  replicaCount: 2
  image:
    repository: phantommesh/discovery
    tag: "latest"
    pullPolicy: Always
  service:
    type: ClusterIP
    port: 8081
  resources:
    limits:
      cpu: 500m
      memory: 1Gi
    requests:
      cpu: 100m
      memory: 256Mi
  autoscaling:
    enabled: true
    minReplicas: 2
    maxReplicas: 5
    targetCPUUtilizationPercentage: 60
  nodeSelector: {}
  tolerations: []
  affinity:
    podAntiAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
        - weight: 100
          podAffinityTerm:
            labelSelector:
              matchLabels:
                app: discovery
            topologyKey: kubernetes.io/hostname

# Monitoring settings
monitoring:
  prometheus:
    enabled: true
    image:
      repository: prom/prometheus
      tag: "v2.48.0"
    service:
      type: ClusterIP
      port: 9090
    persistence:
      enabled: true
      size: 20Gi
    resources:
      limits:
        cpu: 500m
        memory: 1Gi
      requests:
        cpu: 100m
        memory: 256Mi

  grafana:
    enabled: true
    image:
      repository: grafana/grafana
      tag: "10.2.3"
    service:
      type: ClusterIP
      port: 3000
    adminUser: admin
    adminPassword: phantomadmin
    persistence:
      enabled: true
      size: 10Gi
    resources:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 128Mi

# Ingress settings
ingress:
  enabled: true
  className: "nginx"
  annotations:
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
  hosts:
    - host: vpn.phantom-mesh.example.com
      paths:
        - path: /
          pathType: Prefix
          service:
            name: phantom-node
            port: 8080
    - host: grafana.phantom-mesh.example.com
      paths:
        - path: /
          pathType: Prefix
          service:
            name: grafana
            port: 3000
  tls:
    - secretName: phantom-mesh-tls
      hosts:
        - vpn.phantom-mesh.example.com
        - grafana.phantom-mesh.example.com

# Service Mesh settings
serviceMesh:
  istio:
    enabled: false
    version: "1.20.0"
  linkerd:
    enabled: false
    version: "stable-2.14.0"

# Security settings
security:
  networkPolicies:
    enabled: true
  podSecurityStandards:
    enabled: true
    level: "restricted"

# Multi-region settings
multiRegion:
  enabled: false
  regions:
    - name: us-east-1
      primary: true
    - name: eu-west-1
      primary: false
